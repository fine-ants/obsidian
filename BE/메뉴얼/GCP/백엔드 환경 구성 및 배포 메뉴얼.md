
## VM 인스턴스 생성
Compute Engine 서비스로 이동 후 인스턴스를 만듭니다.
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829134751.png)

인스턴스 생성 정보 입력
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829134652.png)

![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829135031.png)

부팅 디스크 이미지 변경
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829140226.png)

네트워킹 설정
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829140347.png)

![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829140445.png)

![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829140452.png)

인스턴스 생성 확인
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829140826.png)

VPC 네트워크 -> 방화벽 서비스로 이동
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829141836.png)

방화벽 규칙 만들기
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829141915.png)

방화벽 규칙 생성 정보 입력
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829142508.png)
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829142528.png)

방화벽 규칙 생성 확인
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829142558.png)

VM 인스턴스 SSH 접속 확인
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829142805.png)

실행 결과를 보면 정상적으로 VM 인스턴스에 SSH 연결된 것을 확인할 수 있습니다.
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829142838.png)

## SSH 키 생성 및 인스턴스 접속
- GCP 콘솔에서 인스턴스를 선택하고 브라우저를 통해서 접속하거나 Cloud Shell을 통해서 접속이 가능합니다. 그러나 해당 인스턴스에 접속하기 위해서는 GCP 콘솔을 통해서만 가능합니다.
- 제가 원하는 것은 로컬 터미널에서 SSH 키를 이용해서 원격 접속하는 것입니다.

### SSH 키 생성하기
ssh-keygen 명령어 형식
```shell
ssh-keygen -t rsa -f ~/.ssh/<KEY_FILENAME> -C <USERNAME>
```
- option `-t` : key 생성 타입을 선택하는 옵션
- option `-f` : 생성할 key 파일의 이름을 설정하는 옵션
- option `-C` : 사용자에 대한 주석을 입력하는 옵션
- `<KEY_FILENAME>` : 개인키 파일 이름
- `<USERNAME>` : GCP VM에서 사용할 사용자명
- 

SSH 키 생성
- 실행 결과를 보면 사용자의 .ssh 디렉토리에 공개키와 개인키가 생성됩니다.
```shell
ssh-keygen -t rsa -f ~/.ssh/gcp_vm -C fineants
```
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829145629.png)

### 생성된 SSH 키를 GCP 콘솔을 통해 서버에 등록하기
생성한 SSH key 쌍 중에서 `.pub` 확장자를 가진 public key를 GCP 콘솔을 통해 서버에 등록해야 합니다.

GCP 콘솔 -> 메타데이터 -> SSH 키 추가
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829150024.png)

SSH 키 값 추가
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829150205.png)

SSH 키 추가 확인
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829150302.png)

### 로컬 SSH 설정 파일에 접속 정보 추가
- 로컬 환경에서 `~/.ssh/config` 파일에 GCP 인스턴스에 SSH 접속하기 위해서 다음과 같이 정보를 추가함
```
Host fineants-gcp
HostName {instance 외부 IP 주소}
User fineants
Port 22
IdentityFile ~/.ssh/gcp_vm
```

SSH 연결 접속 확인
- 실행 결과를 보면 정상적으로 원격 접속하였습니다.
```shell
ssh fineants-gcp
```
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829150822.png)
- fineants@fineants-vm
	- fineants : 사용자이름
	- fineants-vm : 호스트이름


## 백엔드 서버 환경 구성
### 패키지 매니저 업데이트
```shell
sudo apt-get update -y
```
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829152004.png)


### 도커 프로세스 설치
도커 공식 GPG key 추가
```bash
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc
```

Apt 소스들에 저장소 추가하기
- Docker APT 저장소를 시스템에 등록하는 단계
- 등록하면 `apt-get install docker-ce` 같은 명령으로 공식 Docker 패키지 설치 가능
```bash
# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
```

도커 패키지 설치
```shell
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

도커 설치 확인
```shell
sudo docker run hello-world
```
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829153513.png)

현재 사용자를 docker 그룹에 추가
```shell
sudo usermod -aG docker $USER
```

docker 명령어 실행확인
- docker 명령어 실행확인하기 전에 SSH 재접속하시오.
- 다음 실행 결과를 보면 이제 별도의 `sudo` 명령어 접두사없이 docker 명령어를 사용할 수 있습니다.
```shell
docker ps
```
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829153811.png)


### docker-compose 설치
```shell
sudo apt-get update
sudo apt-get install docker-compose-plugin
sudo curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
docker-compose --version
```
![](BE/메뉴얼/GCP/refImg/Pasted%20image%2020250829154344.png)


todo
- 백엔드 코드 release -> production으로 머지
- RDS 데이터베이스 최신  변경
- 