
## Grafana Loki란 무엇인가?
Grafana Loki는 Prometheus에서 영감을 받은 로그 집계 시스템으로, 로깅 및 이벤트 데이터를 수집하고, 저장하고 검색하기 위한 오픈소스 플랫폼입니다.

Loki는 로그 전체 텍스트가 아닌 메타데이터(metadata)만 인덱싱(Indexing)하는 방식을 취합니다. 다음 그림을 보면 Timestamp와 Label 부분만 인덱싱하는 작업을 수행하고, 로깅의 내용 부분은 인덱싱하지 않습니다. 
![[Pasted image 20250210140630.png]]

#### Loki가 메타데이터만 인덱싱하는 이유
Loki가 로그 전체 텍스트가 아닌 메타 데이터만 인덱싱하는 방식을 취하는 이유는 다음과 같습니다.
- 인덱스 크기 최소화
	- 로그 데이터를 완전히 인덱싱하려면 로그 전체 텍스트를 저장해야 하는데, 이는 매우 많은 저장 공간이 필요합니다.
	- 로그 텍스트가 길면 길수록 비효율적이고 비용이 많이 소요됩니다.
	- 대신에 메타 데이터(로그 레벨, 서비스 이름, 파일 이름, 타임스탬프, 라벨 등)만 인덱싱하면 **인덱스 크기가 줄어들어서 빠르게 조회할 수 있고, 저장 비용도 감소**합니다.
- 빠른 검색 및 쿼리 성능 향상
	- Loki는 시간 기반의 로그 쿼리를 자주 실행합니다. 예를 들어, 특정 시간 범위 이내의 로그를 검색하는 경우, 메타 데이터를 인덱싱함으로써 쿼리를 효율적으로 처리할 수 있습니다.
	- 예를 들어 job, instance, level, filename과 같은 메타 데이터를 기준으로 로그를 빠르게 필터링할 수 있습니다.
- 저장 비용 절감
	- 로그 전체 텍스트를 저장하면 저장 비용이 증가됩니다. 하지만 메타 데이터만 인덱싱하면 데이터 크기를 줄일수 있습니다. 이는 비용 절감으로 이어집니다.
	- 실제 로그 메시지 본문은 청크(chunk) 데이터 단위로 저장되며, 검색 시에는 메타 데이터만 참조하여 필요한 데이터를 빠르게 찾습니다. 로그 메시지 본문은 필요할때만 불러오고 검색 효율성을 증가시킵니다.
- 확장성
	- 로그의 양이 급증할 수 있는 환경에서 메타 데이터만 인덱싱하는 방식은 **시스템의 확장성을 높여줍니다.**
	- 전체 로그 텍스트를 인덱싱하면 시스템이 성능 문제를 일으킬 수 있지만, 메타 데이터만 인덱싱하면 더 많은 데이터를 처리할 수 있습니다.

