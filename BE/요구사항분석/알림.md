
### 토큰 저장
- 클라이언트는 FCM 서버로부터 발급받은 토큰을 백엔드 서버에 저장을 요청합니다.
- 클라이언트는 로그인하면서 FCM 토큰을 전달하며 FCM 토큰을 등록해야 합니다.
- 클라이언트는 로그아웃하면서 FCM 토큰의 등록번호를 전달하며 FCM 토큰을 제거해야 합니다.

토큰 저장 입력 정보
- FCM 발급 받은 토큰

### 포트폴리오 목표 수익률 도달 알림 설정
- 사용자는 특정한 포트폴리오의 목표 수익 알림 설정을 할 수 있습니다.

### 포트폴리오 최대 손실율 도달 알림 설정
- 사용자는 특정한 포트폴리오의 최대 손실 알림 설정을 할 수 있습니다.

### 알림 설정
사용자는 클라이언트 애플리케이션의 데스크탑 설정 및 사용자 알림 설정을 수정할 수 있습니다.
- 브라우저로부터 데스크탑 알림 받기는 사용자가 애플리케이션으로부터 브라우저 알림을 받을 것인지 설정하는 옵션입니다.
	- 기본값 : false
- 포트폴리오 목표 수익률 도달 알림 설정은 사용자가 애플리케이션으로부터 각각의 포트폴리오에 설정된 목표 수익률 도달 알림을 받을 것인지 설정하는 옵션입니다.
	- 기본값 : true
	- 해당 옵션이 false이면 각 포트폴리오의 목표 수익률 도달 알림이 true여도 알림을 받지 않습니다. 즉, 전체 포트폴리오의 목표 수익률 도달 알림을 받지 않겠다는 것을 의미합니다.
- 포트폴리오 최대 손실율 도달 알림 설정은 사용자가 애플리케이션으로부터 각각의 포트폴리오에 설정된 최대 손실율 도달 알림을 받을 것인지 설정하는 옵션입니다.
	- 기본값 : true
	- 해당 옵션도 false이면 목표 수익율 도달 알림 설정과 동일합니다.
- 종목 지정가 알림 설정은 사용자가 애플리케이션으로부터 특정한 종목이 특정한 가격에 도달했음을 알려주는 설정입니다.
	- 기본값 : true
	- 해당 옵션이 false이면 특정한 종목 지정가 알림이 활성화되어 있어도 전부 알림을 받지 않습니다.
- 해당 알림 설정이 false로 변경되어도 각 포트폴리오 및 지정가에 설정된 상세 알림 설정은 변경되지 않는다. 예를 들어 포트폴리오의 목표 수익률 도달 알림 설정이 false로 변경되어도 각 특정한 포트폴리오에 설정된 목표 수익율 도달 알림은 false로 변경되지 않는다.
![[Pasted image 20240131153924.png]]

### 지정가 알림 추가
- 사용자는 알림을 받을 특정한 종목의 지정가를 추가할 수 있습니다. 
- 사용자는 종목당 최대 5개까지의 지정가 알림을 추가할 수 있습니다.
- 종목의 지정가는 음수일 수 없습니다.
- 지정가 알림 추가 입력 정보
	- 지정가 가격
### 지정가 알림 제거
- 사용자는 알림을 받을 특정한 종목의 지정가를 삭제할 수 있습니다.

### 활성 알림 목록 조회
- 사용자는 활성 알림 페이지에 접속시 종목 및 포트폴리오에 설정된 알림 목록을 볼 수 있어야 합니다.

활성 알림 목록 조회 응답 정보
종목
- 회사명
- 지정가 목록
	- 지정가 구성
		- 지정가 알림 등록번호
		- 지정가 금액
- 포트폴리오 목록
	- 포트폴리오 구성
		- 포트폴리오 등록번호
		- 이름
		- 목표 수익률 알림 설정
			- 해당 값은 true / false 값을 갖습니다.
		- 최대 손실율 알림 설정
			- 해당 값은 true / false 값을 갖습니다.

### 회원 알림 목록 조회
- 사용자는 웹 애플리케이션을 실행하면서 그동안 온 알림들을 조회합니다.
- **알림 조회시 읽지 않은 알림들과 읽었지만 삭제하지 않은 알림들을 조회**합니다.
- 알림 목록 조회시 최근에 온 알림 메시지가 앞으로 와야 합니다.

### 회원 알림 모두 읽음
- 사용자는 알림 메시지들을 모두 읽을 수 있습니다.
- 클라이언트는 알람 모두 읽음 처리를 위해서 서버로 알림의 등록번호 리스트를 전달하며 읽음 처리를 요청합니다.
- 서버는 알림 등록번호 리스트를 받아서 해당하는 알림들을 읽음 처리합니다.

### 회원 특정 알림 읽음
- 사용자는 특정한 알림을 읽을 수 있습니다.
- 클라이언트는 알림 읽음 처리를 위해서 서버로 알림의 등록번호를 전달하며 읽음 처리를 요청합니다.
- 서버는 알림 등록번호를 받아서 해당하는 알림을 읽음 처리합니다.

### 회원 알림 단일 지우기
- 사용자는 특정한 알림을 선택하고 지우기를 할 수 있습니다.
- 서버는 특정 알림 등록번호를 받아서 Soft Delete 처리합니다.

### 회원 알림 모두 지우기
- 사용자는 알림 메시지들을 모두 지울 수 있습니다.
- 서버는 특정 알림 등록번호들을 받아서 Soft Delete 처리합니다.


### 클라이언트에게 푸시 알림(Push Notification) 전송
- 백엔드 서버는 회원들의 포트폴리오 및 지정가에 대한 푸시 알림을 보낼 수 있어야 합니다.
- 백엔드 서버가 회원들에게 전송할 알림 종류는 다음과 같습니다.
	- 포트폴리오
		- 목표 수익 금액 달성 알림
		- 최대 손실 금액 도달 알림
	- 종목
		- 회원이 추가한 종목의 지정가 도달 알림
- 포트폴리오 목표수익 금액 달성 알림 조건
	- 포트폴리오의 목표수익 금액 알림이 활성되어야 있어야 합니다.
	- 회원 계정의 목표수익 금액 알림(targetGainNotify)이 활성화 되어 있어야 합니다.
	- 포트폴리오의 현재 잔고(현금) + 포트폴리오 총 손익이 포트폴리오의 목표 수익금액보다 같거나 커야합니다.
		- 현금 + 포트폴리오 총손익 >= 목표수익금액
	- 해당 포트폴리오의 목표 수익금액 달성 알림ㅇ
- 